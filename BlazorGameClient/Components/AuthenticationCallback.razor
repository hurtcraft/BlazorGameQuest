@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthenticationStateProvider

<div style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column;">
    <p>Connexion réussie ! Redirection en cours...</p>
</div>

@code {
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Attendre que l'authentification soit complètement terminée
            await Task.Delay(1000);
            
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            if (authState.User.Identity?.IsAuthenticated == true)
            {
                // Rediriger vers la page par défaut après connexion réussie
                Navigation.NavigateTo("/TableauScore", forceLoad: true);
            }
            else
            {
                // Si l'authentification a échoué, retourner à la page de login
                Navigation.NavigateTo("/", forceLoad: true);
            }
        }
    }
}

